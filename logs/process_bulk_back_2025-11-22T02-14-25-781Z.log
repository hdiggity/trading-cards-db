Processing 3x3 grid BACK images (PRIMARY input source)...
Processing 1 images from provided file list
Found 1 grid back images to process
Found 3001 front images available for backup matching
Pipeline: BACKS (primary) → Enhanced Processing → Front Matching (backup)
[1/1] Processing: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
processing: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
2025-11-21 21:14:26,606 - trading_cards - INFO - [filesystem] File uploaded: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
2025-11-21 21:14:31,847 - trading_cards - ERROR - Failed to log to database: (sqlite3.OperationalError) database is locked
[SQL: INSERT INTO system_logs (level, source, action, message, details, meta_data, session_id, user_agent, image_filename) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, timestamp]
[parameters: ('info', 'filesystem', 'upload', 'File uploaded: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg', 'File size: 447886 bytes, Type: .jpeg', None, 'session_20251121_211426_68978', None, '3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-11-21 21:14:31,847 - trading_cards - INFO - [filesystem] File uploaded: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
2025-11-21 21:14:31,852 - trading_cards - INFO - [system] Upload status changed: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg -> processing
2025-11-21 21:14:31,856 - trading_cards - INFO - [image_processing] Started processing: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
Processing 3x3 grid as PRIMARY input: cards/unprocessed_bulk_back/3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
Using detailed individual card processing for maximum detail extraction...
Starting detailed 3x3 grid processing: cards/unprocessed_bulk_back/3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg
Extracting individual cards from grid...
Hough detection incomplete, trying smart edge detection...
Extracted 9 individual cards
Converting cards to base64 with high-contrast variants...
Analyzing cards with GPT-4 Vision (using dual image variants)...
2025-11-21 21:15:43,248 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-21 21:15:43,272 - trading_cards - SUCCESS - [image_processing] Grid processing complete: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg (9 cards)
2025-11-21 21:15:43,279 - trading_cards - INFO - [system] Upload status changed: 3FA426BB-188D-4E91-9FCB-BCB3EEB46E9F_1_105_c.jpeg -> pending_verification
Detailed processing extracted 9 cards
Grid context: year=1984, brand=Topps, sport=baseball, set=n/a
Using front images as BACKUP to supplement missing data from backs...
Matching front images from cards/unprocessed_single_front
Found 2292 front images; limiting to 10 most recent for matching
Applied general image enhancement
Detailed grid processing completed: 9 cards analyzed
2025-11-21 21:15:44,247 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
LLM call failed (final): Error code: 400 - {'error': {'message': "You uploaded an unsupported image. Please make sure your image has of one the following formats: ['png', 'jpeg', 'gif', 'webp'].", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_format'}}
Error processing front image cards/unprocessed_single_front/IMG_3158_optimized.png: Error code: 400 - {'error': {'message': "You uploaded an unsupported image. Please make sure your image has of one the following formats: ['png', 'jpeg', 'gif', 'webp'].", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_format'}}
Applied general image enhancement
2025-11-21 21:16:02,621 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Applied general image enhancement
2025-11-21 21:16:02,758 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
LLM call failed (final): Error code: 400 - {'error': {'message': "You uploaded an unsupported image. Please make sure your image has of one the following formats: ['png', 'jpeg', 'gif', 'webp'].", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_format'}}
Error processing front image cards/unprocessed_single_front/IMG_2323_optimized.png: Error code: 400 - {'error': {'message': "You uploaded an unsupported image. Please make sure your image has of one the following formats: ['png', 'jpeg', 'gif', 'webp'].", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_format'}}
Applied general image enhancement
2025-11-21 21:16:20,049 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Applied general image enhancement
2025-11-21 21:16:40,163 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Applied general image enhancement
2025-11-21 21:17:02,798 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Applied general image enhancement
2025-11-21 21:17:13,168 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Applied general image enhancement
2025-11-21 21:17:20,880 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Applied general image enhancement
